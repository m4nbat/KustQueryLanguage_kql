# CVE-2023-23397

SIGMA rules links:
- Florian Roth: https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_susp_execution.yml


## SecurityEvent

`SecurityEvent | where EventID == 4688 | where (ParentProcessName endswith @'\svchost.exe' and NewProcessName endswith @'\rundll32.exe' and CommandLine contains @'C:\windows\system32\davclnt.dll,DavSetCookie' and CommandLine matches regex @'(?i)://\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}') and not (CommandLine has_any (@'://10.',@'://192.168.',@'://172.16.',@'://172.17.',@'://172.18.',@'://172.19.',@'://172.20.',@'://172.21.',@'://172.22.',@'://172.23.',@'://172.24.',@'://172.25.',@'://172.26.',@'://172.27.',@'://172.28.',@'://172.29.',@'://172.30.',@'://172.31.',@'://127.',@'://169.254.'))`


## Defender for Endpoint

`DeviceProcessEvents | where (InitiatingProcessFolderPath endswith @'\svchost.exe' and FolderPath endswith @'\rundll32.exe' and ProcessCommandLine contains @'C:\windows\system32\davclnt.dll,DavSetCookie' and ProcessCommandLine matches regex @'(?i)://\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}') and not (ProcessCommandLine has_any (@'://10.',@'://192.168.',@'://172.16.',@'://172.17.',@'://172.18.',@'://172.19.',@'://172.20.',@'://172.21.',@'://172.22.',@'://172.23.',@'://172.24.',@'://172.25.',@'://172.26.',@'://172.27.',@'://172.28.',@'://172.29.',@'://172.30.',@'://172.31.',@'://127.',@'://169.254.'))`

# Defender for Endpoint / Sentinel TVM 

DeviceTvmSoftwareVulnerabilities
| where CveId =~ "CVE-2023-23397"
| distinct DeviceName
